<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;500;600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/main-modular.css">
  <!-- Biblioteca Medium Zoom para zoom de alta qualidade -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>

  <!-- Estilos para o novo visualizador -->
  <style>
    /* Estilo para loader de alta resolu√ß√£o */
    .highres-loader {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 15px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      z-index: 10;
    }

    .highres-loader .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: var(--color-gold);
      animation: spin 1s ease-in-out infinite;
    }

    /* Zoom personalizado */
    .zoom-img {
      transition: transform 0.3s ease;
      cursor: zoom-in;
    }

    /* Container de imagem no lightbox */
    .lightbox-img-wrapper {
      transition: all 0.3s ease;
    }

    /* Estilos para loader de texto */
    .loader-text {
      font-size: 14px;
      font-weight: 400;
      color: white;
    }

    /* Melhorias na UI de zoom */
    .medium-zoom-overlay {
      z-index: 990;
    }

    .medium-zoom-image--opened {
      z-index: 991;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Bot√µes de navega√ß√£o no canto superior direito -->
    <button id="logout-button" class="logout-button" onclick="returnToLogin()" title="Return to login">
      Logout
    </button>
    <button id="help-button" class="help-button" onclick="showTutorial()" title="How to use this gallery">
      <span class="help-icon">?</span>
    </button>

    <!-- Nova estrutura com menu lateral e conte√∫do -->
    <div class="catalog-layout">
      <!-- Menu lateral de categorias -->
      <div class="category-sidebar">
        <h3>Categories</h3>
        <div class="category-search">
          <input type="text" id="category-search-input" placeholder="Search categories...">
        </div>
        <div id="categories-menu" class="categories-menu">
          <!-- Categorias ser√£o carregadas aqui -->
          <div class="category-loading">Loading categories...</div>
        </div>
      </div>

      <!-- Conte√∫do principal -->
      <div class="content-area">
        <!-- √Årea de conte√∫do (galeria) -->
        <div id="content" class="gallery">
          <div class="empty-message">Loading our exquisite collection...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Cart Panel -->
  <div id="cart-panel" class="cart-panel">
    <h3>Selected Items: <span id="cart-count">0</span></h3>
    <button class="btn btn-gold" onclick="showCart()">View Selection</button>
  </div>

  <!-- Cart Modal -->
  <div id="cart-modal" class="modal cart-modal">
    <div class="modal-content">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h2 style="margin: 0;">Your Selection</h2>
      <button class="btn btn-outline-secondary" onclick="showOrderBreakdown()" style="font-size: 12px; padding: 6px 12px;">
        üìä Details
      </button>
    </div>
      <div id="cart-items-container">
        <div id="cart-items">
          <!-- Cart items will be added here -->
        </div>
      </div>

      <!-- Criar novo container para o total FORA da √°rea de scroll -->
    <div id="cart-total-container"></div>
    <div class="luxury-divider"></div>

    <div class="form-group">
      <label for="observations">Special Instructions (optional)</label>
      <textarea id="observations" class="form-control"
        placeholder="Add any special requirements or comments"></textarea>
    </div>

    <div style="display: flex; justify-content: flex-end; gap: 15px;">
        <button class="btn btn-secondary" onclick="closeModal('cart-modal')">Cancel</button>
        <button class="btn btn-gold" onclick="submitOrder()">Submit Order</button>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div id="success-modal" class="modal">
    <div class="modal-content" style="text-align: center;">
      <h2 style="padding-bottom: 0; margin-bottom: 15px;">Thank You For Your Order</h2>
      <div style="margin: 20px 0;">
        <p style="color: #2e7d32; font-weight: 500; margin-bottom: 15px;">
          ‚úÖ Your selected photos have been reserved successfully!
        </p>
        <p style="margin-bottom: 15px;">
          Your premium cowhides are now held exclusively for you and will be available upon payment confirmation.
        </p>
        <p style="color: #666;">
          Our sales team will contact you shortly to arrange payment and delivery details.
        </p>
      </div>
      <div class="success-actions">
        <button class="btn btn-gold action-button" onclick="returnToLogin()">
          Return to Login
        </button>
      </div>
    </div>
  </div>

  <!-- Lightbox for photo viewing -->
  <div id="lightbox" class="lightbox">
    <div class="lightbox-content">
      <div class="lightbox-close" onclick="closeLightbox()">&times;</div>
      <div class="return-to-cart" onclick="returnToCart()">‚Üê Return to Selection</div>

      <div class="lightbox-img-container">
        <!-- The iframe will be inserted here by JavaScript -->
        <div class="lightbox-nav">
          <button class="nav-left" onclick="navigatePhotos(-1)">&lt;</button>
          <button class="nav-right" onclick="navigatePhotos(1)">&gt;</button>
        </div>
      </div>

      <div class="lightbox-info">
        <p id="lightbox-name">Product Name</p>
      </div>

      <div class="lightbox-controls">
        <!-- Cart Icon with Count -->
        <div class="cart-icon">
          <div class="icon"></div>
          <div id="lightbox-cart-count" class="count">0</div>
        </div>

        <button id="lightbox-add-btn" class="btn btn-gold" onclick="addRemoveLightbox()">
          Add to Selection
        </button>
        <button class="btn btn-secondary" onclick="closeLightbox()">
          Back to Gallery
        </button>
      </div>
    </div>
  </div>

  <!-- Loader -->
  <div id="loader" class="loader">
    <div class="loader-content">
      <div class="luxury-loader">
        <!-- Mensagem que troca -->
        <div class="loader-message-container">
          <div class="message-item active">Curating premium hides for you...</div>
          <div class="message-item">Selecting exquisite leathers...</div>
          <div class="message-item">Preparing your exclusive collection...</div>
          <div class="message-item">Revealing nature's finest textures...</div>
        </div>

        <!-- T√≠tulo -->
        <div class="loader-title">Sunshine Cowhides</div>
        <div class="loader-subtitle">Gallery</div>

        <!-- √öNICA linha dourada -->
        <div class="golden-line"></div>

        <!-- Barra de progresso -->
        <div class="loader-progress">
          <div class="progress-bar"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Customer Code Entry Modal -->
  <div id="code-entry-modal" class="modal" style="display: block;"> <!-- Start visible -->
    <div class="modal-content" style="max-width: 400px; text-align: center;">
      <h2>Welcome</h2>
      <p>Please enter your access code to view our premium leather collection.</p>

      <div class="form-group">
        <input type="text" id="access-code" class="form-control"
          style="font-size: 24px; text-align: center; letter-spacing: 5px;" placeholder="0000" maxlength="4"
          pattern="[0-9]*">
      </div>

      <button class="btn btn-gold" style="width: 100%;" onclick="accessGallery()">Enter Gallery</button>

      <div style="margin-top: 20px; font-size: 14px;">
        <a href="#" onclick="event.preventDefault(); showAdminLogin()">Admin Access</a>
      </div>
    </div>
  </div>

  <!-- Admin Login Modal -->
  <div id="admin-login-modal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
      <h2>Admin Access</h2>
      <div class="form-group">
        <label for="admin-email">Email</label>
        <input type="email" id="admin-email" class="form-control" placeholder="Enter admin email">
      </div>
      <form id="admin-password-form" onsubmit="event.preventDefault(); adminLogin();">
        <div class="form-group">
          <label for="admin-password">Password</label>
          <input type="password" id="admin-password" class="form-control" placeholder="Enter password">
        </div>
      </form>
      <div style="display: flex; justify-content: flex-end; gap: 15px;">
        <button class="btn btn-secondary" onclick="closeModal('admin-login-modal')">Cancel</button>
        <button class="btn btn-gold" onclick="adminLogin()">Login</button>
      </div>
    </div>
  </div>

  <!-- Admin Panel Modal with Tabs -->
  <div id="admin-panel-modal" class="modal">
    <div class="modal-content">
      <!-- Logout button at the top right -->
      <button class="btn btn-secondary logout-top-right" onclick="adminLogout()">Logout</button>

      <button class="mobile-close-btn" onclick="adminLogout()" style="display: none;">√ó</button>

      <h2>Admin Panel</h2>

      <!-- Tab Navigation -->
      <div class="admin-tabs">
        <button class="tab-button active" onclick="switchTab('customer-codes')">Customer Management</button>
        <button class="tab-button" onclick="switchTab('order-management')">Order Management</button>
        <button class="tab-button" onclick="switchTab('price-management')">Price Management</button>
        <button class="tab-button" onclick="switchTab('photo-storage')">Photo Storage</button>
        <button class="tab-button" onclick="switchTab('shipment-control')">Shipment Control</button>
      </div>

      <!-- Tab Content -->
      <div class="tab-content">
        <!-- Customer Codes Tab -->
        <div id="customer-codes" class="tab-pane active">
          <div class="admin-section">
            <h3>Generate New Customer Code</h3>
            <div class="form-group">
              <label for="customer-name">Customer Name</label>
              <input type="text" id="customer-name" class="form-control" placeholder="Enter customer name">
            </div>
            <button class="btn btn-gold" onclick="generateCustomerCode()">Generate Code</button>
            <div id="generated-code" style="margin-top: 15px; font-size: 24px; text-align: center; display: none;">
              <p>New Code: <span id="new-code"></span></p>
              <p style="font-size: 14px;">Share this code with your customer</p>
            </div>
          </div>

          <div class="luxury-divider"></div>

          <div class="admin-section">
            <h3>Active Customer Codes</h3>
            <div id="active-codes-container"
              style="max-height: 200px; overflow-y: auto; margin-bottom: 15px; border: 1px solid rgba(0,0,0,0.1); border-radius: 4px; padding: 10px;">
              <div id="active-codes-list">Loading...</div>
            </div>
          </div>
        </div>

        <!-- Order Management Tab -->
        <div id="order-management" class="tab-pane">
          <div class="admin-section">
            <h3>Order Management</h3>

            <div class="form-group">
              <label for="order-status">Select Order Status to View</label>
              <select id="order-status" class="form-control" onchange="loadOrderFolders(this.value)">
                <option value="waiting">Waiting Payment</option>
                <option value="paid">Paid/Sold</option>
              </select>
            </div>

            <div id="order-folders-container"
              style="max-height: 300px; overflow-y: auto; margin-bottom: 15px; border: 1px solid rgba(0,0,0,0.1); border-radius: 4px; padding: 10px;">
              <div id="order-folders-list">
                <p>Select a status to view orders</p>
              </div>
            </div>

            <!-- Keep this hidden - it's used by the JavaScript functions -->
            <input type="hidden" id="order-folder" class="form-control">

            <div style="display: flex; gap: 10px;">
              <button class="btn btn-secondary" onclick="refreshFolderList()">Refresh List</button>
            </div>
          </div>
        </div>

        <!-- Price Management Tab - COM ESTAT√çSTICAS NO HEADER -->
        <div id="price-management" class="tab-pane">
          <!-- Header com t√≠tulo e estat√≠sticas -->
          <div class="admin-header">
            <div class="admin-title-section">
              <h2 class="admin-title">
                <i class="fas fa-dollar-sign"></i>
                Price Management
              </h2>
            </div>
            <div class="admin-stats-section">
              <span id="price-header-stats" class="header-stats">Loading...</span>
              <button class="btn btn-gold btn-sm" onclick="openBulkActionsModal()" 
                      style="margin-left: 10px; padding: 5px 10px; font-size: 12px;" 
                      title="Bulk price actions">
                üìä Bulk Actions
              </button>
              <button class="btn btn-secondary btn-sm" onclick="refreshPriceCounters()" 
                      style="margin-left: 8px; padding: 5px 10px; font-size: 12px;" 
                      title="Refresh photo counters">
                   Refresh
              </button>
            </div>
          </div>

          <!-- Container principal do price management -->
          <div id="category-price-container">
            <!-- Conte√∫do ser√° carregado dinamicamente pelo JavaScript -->
          </div>
        </div>

        <style>
          /* Estilos para o header com estat√≠sticas */
          .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 0 2px;
          }

          .admin-title-section {
            flex: 1;
          }

          .admin-title {
            margin: 0;
            color: #333;
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
          }

          .admin-title i {
            color: var(--color-gold);
            font-size: 22px;
          }

          .admin-stats-section {
            flex: 0 0 auto;
          }

          .header-stats {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            font-size: 13px;
            font-weight: 500;
            color: #666;
            white-space: nowrap;
          }

          /* Responsividade do header */
          @media (max-width: 768px) {
            .admin-header {
              flex-direction: column;
              align-items: flex-start;
              gap: 8px;
            }

            .admin-title {
              font-size: 20px;
            }

            .admin-stats-section {
              align-self: flex-end;
            }

            .header-stats {
              font-size: 12px;
              padding: 4px 8px;
            }
          }

          @media (max-width: 480px) {
            .admin-title {
              font-size: 18px;
            }

            .admin-title i {
              font-size: 16px;
            }

            .header-stats {
              font-size: 11px;
              padding: 3px 6px;
            }
          }
        </style>

        <!-- NOVA ABA: Photo Storage -->
        <div id="photo-storage" class="tab-pane">
          <div class="admin-section">
            <!-- Cabe√ßalho minimalista com contador discreto -->
            <div class="photo-storage-header">
              <h3>Photo Storage Management</h3>
              <div class="discrete-stats">
                <span id="discrete-photo-count">Loading...</span>
                <button class="btn btn-secondary btn-sm" onclick="photoManager.refreshStructure()">Refresh</button>
                <button class="btn btn-primary btn-sm" onclick="photoManager.openCreateFolderModal()">üìÅ New</button>
                <button class="btn btn-gold btn-sm" onclick="photoManager.openUploadModal()">üî∫ Update</button>
              </div>
            </div>

            <!-- FOCO PRINCIPAL: Lista de Pastas (90% do espa√ßo) -->
            <div class="folder-management-focused">
              <div class="folder-tree-expanded">
                <div id="folder-tree" class="folder-tree">
                  <div class="loading">Loading folder structure...</div>
                </div>
              </div>
            </div>

            <!-- Panel de fotos (mantido como estava) -->
            <div class="photo-management-panel" style="display: none;">
              <h4>Photos in: <span id="current-folder-name"></span></h4>
              <div id="folder-photos">
                <!-- Photos will be loaded here -->
              </div>
            </div>
          </div>
        </div>

        <!-- NOVA ABA: Shipment Control -->
        <div id="shipment-control" class="tab-pane">
          <div class="admin-section">
            <h3>Shipment Control</h3>
            <p>Em desenvolvimento...</p>
          </div>
        </div>
      </div>
    </div>

  </div>
  </div>

  <!-- Hidden footer div (replaced by top-right logout button) -->
  <div class="admin-footer" style="display: none;"></div>
  </div>

  <!-- Custom Notification Toast -->
  <div id="custom-toast"
    style="display: none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1000; min-width: 300px; max-width: 500px; background-color: var(--color-dark); color: white; border-radius: 6px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); overflow: hidden;">
    <div id="toast-header" style="padding: 12px 20px; display: flex; align-items: center;">
      <div id="toast-icon" style="margin-right: 12px; font-size: 18px;">‚úì</div>
      <div id="toast-title" style="font-weight: 600; font-family: 'Playfair Display', serif;">Success</div>
      <button onclick="hideToast()"
        style="margin-left: auto; background: none; border: none; color: white; font-size: 18px; cursor: pointer; padding: 0 0 0 15px;">&times;</button>
    </div>
    <div id="toast-progress" style="height: 3px; width: 100%; background-color: var(--color-gold);"></div>
    <div id="toast-body" style="padding: 15px 20px;">Message here</div>
  </div>

  <!-- Custom Confirmation Dialog -->
  <div id="custom-confirm" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 450px; text-align: center;">
      <h2 id="confirm-title">Confirmation</h2>
      <p id="confirm-message" style="margin-bottom: 25px;">Are you sure you want to proceed?</p>

      <div style="display: flex; justify-content: center; gap: 15px;">
        <button id="confirm-cancel" class="btn btn-secondary" onclick="handleConfirmResponse(false)">Cancel</button>
        <button id="confirm-ok" class="btn btn-gold" onclick="handleConfirmResponse(true)">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Customer Category Access Modal -->
  <div id="category-access-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 900px; width: 95%;">
      <h2>Edit Access for <span id="customer-name-title"></span></h2>
      <p>Configure which categories this customer can access and set custom prices.</p>

      <!-- NOVA ESTRUTURA DE TABS -->
      <div class="admin-tabs">
        <button class="tab-button active" onclick="switchModalTab('volume-tab', this)">Volume Discounts</button>
        <button class="tab-button" onclick="switchModalTab('categories-tab', this)">Categories</button>
      </div>

      <!-- TAB 1: Volume Discounts -->
      <div id="volume-tab" class="tab-content active">
        <div class="volume-discounts-section"
          style="margin: 20px 0; padding: 15px; border: 2px solid #D4AF37; border-radius: 8px; background-color: #fefdf8;">
          <h3 style="margin-top: 0; color: #8B4513;">üìä Volume Discounts (Total Order)</h3>
          <p style="margin-bottom: 15px; color: #666; font-size: 14px;">Set discounts based on total quantity of photos
            in the order</p>

          <div class="volume-discount-controls" style="margin-bottom: 15px;">
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
              <input type="number" id="volume-min-qty" placeholder="Min Qty" min="1" style="width: 100px;">
              <input type="number" id="volume-max-qty" placeholder="Max Qty (optional)" min="1" style="width: 120px;">
              <input type="number" id="volume-discount-percent" placeholder="Discount %" min="0" max="100" step="0.1"
                style="width: 120px;">
              <button class="btn btn-gold" onclick="addVolumeDiscount()" style="padding: 8px 15px;">Add Range</button>
            </div>
          </div>

          <div class="volume-discounts-list">
            <table class="volume-discounts-table" style="width: 100%; border-collapse: collapse;">
              <thead>
                <tr style="background-color: #f8f9fa;">
                  <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">Min Qty</th>
                  <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">Max Qty</th>
                  <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">Discount %</th>
                  <th style="padding: 8px; text-align: center; border: 1px solid #ddd;">Actions</th>
                </tr>
              </thead>
              <tbody id="volume-discounts-tbody">
                <tr id="no-volume-discounts">
                  <td colspan="4" style="padding: 15px; text-align: center; color: #666; font-style: italic;">No volume
                    discounts configured</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- TAB 2: Categories -->
      <div id="categories-tab" class="tab-content" style="display: none;">
        <div class="global-actions">
          <button class="btn btn-gold" onclick="authorizeAllCategories()">Authorize All</button>
          <button class="btn btn-secondary" onclick="clearAllCategories()">Clear All</button>
        </div>

        <div class="table-filter">
          <input type="text" id="category-access-filter" class="form-control" placeholder="Filter categories..."
            onkeyup="filterAccessCategories()">
          <div class="filter-stats">Showing <span id="access-displayed-count">0</span> of <span
              id="access-total-count">0</span> categories</div>
        </div>

        <div class="category-access-container">
          <table class="category-access-table">
            <thead>
              <tr>
                <th style="width: 80px;">Access</th>
                <th>Category</th>
                <th style="width: 100px;">Photos</th>
                <th style="width: 120px;">Default Price</th>
                <th style="width: 120px;">Custom Price</th>
                <th style="width: 120px;">Min Quantity</th>
                <th style="width: 120px;">Discount %</th>
              </tr>
            </thead>
            <tbody id="category-access-list">
              <!-- Categories will be added here dynamically -->
              <tr>
                <td colspan="7" class="loading-text">Loading categories...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="modal-buttons">
        <button class="btn btn-secondary" onclick="closeModal('category-access-modal')">Cancel</button>
        <button class="btn btn-gold" onclick="saveCustomerCategoryAccess()">Save Changes</button>
      </div>
    </div>
  </div>

  <!-- Bulk Actions Modal -->
  <div id="bulk-actions-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 500px; width: 90%;">
      <h2>üìä Bulk Price Actions</h2>
      <p>Apply price changes to multiple categories at once.</p>

      <div class="form-group">
        <label for="bulk-update-type-modal">Update Type:</label>
        <select id="bulk-update-type-modal" class="form-control">
          <option value="fixed">Set Fixed Price</option>
          <option value="percentage">Adjust by Percentage</option>
        </select>
      </div>

      <div class="form-group">
        <label for="bulk-value-modal">Value:</label>
        <input type="number" id="bulk-value-modal" class="form-control" 
               placeholder="Enter value" step="0.01" style="font-size: 16px;">
        <small class="form-text text-muted">
          <span id="bulk-help-text">Enter the new fixed price for all selected categories</span>
        </small>
      </div>

      <div class="bulk-selection-info" style="margin: 15px 0; padding: 10px; background: #f8f9fa; border-radius: 4px;">
        <strong>Selected Categories: <span id="bulk-selected-count">0</span></strong>
        <div id="bulk-selected-preview" style="font-size: 13px; color: #666; margin-top: 5px;">
          Please select categories from the table first.
        </div>
      </div>

      <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px;">
        <button class="btn btn-secondary" onclick="closeBulkModal()">Cancel</button>
        <button class="btn btn-gold" onclick="applyBulkFromModal()" id="apply-bulk-modal-btn" disabled>
          Apply Changes
        </button>
      </div>
    </div>
  </div>

  <!-- Return to Stock Modal - SEPARADO -->
  <div id="return-to-stock-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 900px; width: 95%;">
      <h2>Return Photos to Stock</h2>
      <p>Select which photos you want to return to the main gallery from: <strong><span
            id="return-order-name"></span></strong></p>

      <div id="return-modal-loading" class="loading-message">Loading order photos...</div>

      <div id="return-modal-content" style="display: none;">
        <!-- Categories will be loaded here -->
        <div id="return-categories-container">
          <!-- Dynamic content -->
        </div>

        <div class="luxury-divider"></div>

        <div class="return-summary">
          <p><strong>Selected:</strong> <span id="return-selected-count">0</span> photos</p>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeReturnAndShowAdmin()">Cancel</button>
        <button class="btn btn-gold" onclick="processReturnToStock()" id="process-return-btn" disabled>
          Return Selected Photos
        </button>
      </div>
    </div>
  </div>

  <!-- Order Details Modal - ESTRUTURA OTIMIZADA -->
  <div id="order-details-modal" class="modal">
    <div class="modal-content order-details-modal-content">
      
      <!-- CABE√áALHO FIXO -->
      <div class="order-details-header">
        <h2>Order Details</h2>
        <div id="order-loading" class="loading-message">Loading order details...</div>

        <div id="order-details-content" style="display: none;">
          <div class="order-info">
            <p><strong>Order:</strong> <span id="order-name"></span></p>
            <p><strong>Client:</strong> <span id="order-client"></span></p>
            <p><strong>Date:</strong> <span id="order-date"></span></p>
          </div>
          
          <div class="luxury-divider"></div>
          <h3 class="section-title">Items by Category</h3>
        </div>
      </div>

      <!-- √ÅREA DE SCROLL - APENAS AS CATEGORIAS -->
      <div class="order-details-body">
        <div id="category-breakdown" class="category-breakdown-scrollable">
          <!-- Categorias ser√£o inseridas aqui dinamicamente -->
        </div>
      </div>

      <!-- FOOTER FIXO - SEMPRE VIS√çVEL -->
      <div class="order-details-footer">
        <div class="luxury-divider"></div>
        
        <div class="order-totals">
          <div class="order-total-row">
            <span><strong>Total Items:</strong></span>
            <span id="total-items"></span>
          </div>
          <div class="order-total-row">
            <span><strong>Total Amount:</strong></span>
            <span id="total-amount"></span>
          </div>
        </div>

        <div id="order-comments-section" style="display: none;">
          <div class="luxury-divider"></div>
          <h3>Client Comments</h3>
          <div id="order-comments" class="order-comments"></div>
        </div>

        <div class="luxury-divider"></div>
        
        <div class="modal-actions">
          <button class="btn btn-secondary" onclick="closeModal('order-details-modal')">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Order Breakdown Modal -->
  <div id="order-breakdown-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 600px; width: 90%;">
      <h2>Order Breakdown</h2>
      <div id="breakdown-content">
        <!-- Breakdown ser√° gerado aqui -->
      </div>
      <div style="margin-top: 20px; text-align: center;">
        <button class="btn btn-secondary" onclick="closeModal('order-breakdown-modal')">Close</button>
      </div>
    </div>
  </div>

  <!-- App Scripts -->
  <script src="/js/database-service.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/api-client.js"></script>
  <script src="/js/gallery.js"></script>
  <script src="/js/cart.js"></script>
  <script src="/js/lightbox.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/admin.js"></script>
  <script src="/js/photo-manager-admin.js"></script>
  <script src="/js/price-manager.js"></script>
  <script src="/js/sidebar.js"></script>
</body>

</html>