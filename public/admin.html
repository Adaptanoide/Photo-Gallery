<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Sunshine Cowhides</title>

    <!-- Favicons -->
    <link rel="icon" type="image/png" href="/images/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/images/favicon/favicon.svg" />
    <link rel="shortcut icon" href="/images/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png" />
    <link rel="manifest" href="/images/favicon/site.webmanifest" />


    <!-- CSS Base + Admin -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin-dashboard.css">
    <link rel="stylesheet" href="css/admin-components.css">
    <link rel="stylesheet" href="css/admin-clients.css">
    <link rel="stylesheet" href="css/admin-pricing-management.css">
    <link rel="stylesheet" href="css/admin-config.css">
    <link rel="stylesheet" href="css/admin-selections.css">
    <link rel="stylesheet" href="css/admin-special-selections.css">
    <link rel="stylesheet" href="/css/ui-system.css">
    <link rel="stylesheet" href="css/admin-storage.css">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body class="admin-body">
    <!-- Overlay para mobile -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Layout Principal -->
    <div class="admin-layout">
        <!-- Sidebar -->
        <aside id="adminSidebar" class="admin-sidebar">
            <!-- Header da Sidebar -->
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <img width="60px" height="60x" src="/images/logo-transparent.png"
                        alt="logo sunshine painel administrativo">
                    <span>Admin Panel</span>
                </div>
            </div>

            <!-- Navega√ß√£o -->
            <nav class="sidebar-nav">
                <div class="nav-item" style="display:none">
                    <a href="#dashboard" class="nav-link" data-section="dashboard">
                        <i class="fas fa-chart-line"></i>
                        <span class="nav-text">Dashboard</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#clients" class="nav-link active" data-section="clients">
                        <i class="fas fa-users"></i>
                        <span class="nav-text">Client Management</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#pricing" class="nav-link" data-section="pricing">
                        <i class="fas fa-dollar-sign"></i>
                        <span class="nav-text">Price Management</span>
                    </a>

                    <div class="nav-item">
                        <a href="#selections" class="nav-link" data-section="selections">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="nav-text">Selection Management</span>
                            <span class="pending-badge" id="sidebarPendingBadge">0</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#inventory-monitor" class="nav-link" data-section="inventoryMonitor">
                            <i class="fas fa-search"></i>
                            <span class="nav-text">Inventory Monitor(NO ESTA LISTO)</span>
                        </a>
                    </div>
                    <div class="nav-item" style="display:none">
                        <a href="#special-selections" class="nav-link" data-section="special-selections">
                            <i class="fas fa-star"></i>
                            <span class="nav-text">Special Selections</span>
                        </a>
                    </div>
                    <div class="nav-item" style="display:none">
                        <a href="#reports" class="nav-link" data-section="reports">
                            <i class="fas fa-chart-bar"></i>
                            <span class="nav-text">Reports</span>
                        </a>
                    </div>
                    <div class="nav-item" style="display:none">
                        <a href="#storage" class="nav-link" data-section="storage">
                            <span class="nav-text">Storage Management</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#marketing" class="nav-link" data-section="marketing">
                            <i class="fas fa-envelope"></i>
                            <span class="nav-text">Email Marketing</span>
                        </a>
                    </div>
                    <div class="nav-item"> <!-- SEM display:none -->
                        <a href="#settings" class="nav-link" data-section="settings">
                            <i class="fas fa-cog"></i>
                            <span class="nav-text">Settings</span>
                        </a>
                    </div>
            </nav>
        </aside>

        <!-- √Årea Principal -->
        <main id="adminMain" class="admin-main">
            <!-- Header Principal -->
            <header class="admin-header">
                <div class="header-left">
                    <button id="sidebarToggle" class="sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="pageTitle" class="page-title">Client Management</h1>
                </div>

                <div class="header-right">
                    <button id="headerScanBtn" onclick="window.monitor && window.monitor.scan()"
                        style="padding: 8px 16px; border-radius: 8px; color: #000000; font: normal 12pt Arial; font-weight: 600; background: #d4af37; border: none; cursor: pointer; margin-right: 15px; display: none;">
                        <i class="fas fa-search"></i> Scan Now
                    </button>
                    <div class="admin-user" onclick="openProfileModal()" style="cursor: pointer;">
                        <div class="user-avatar" id="userAvatar">A</div>
                        <span class="user-name" id="userName">Admin</span>
                    </div>
                    <button onclick="logout()" class="btn btn-primary">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="btn-text">Logout</span>
                    </button>
                </div>
            </header>

            <!-- Conte√∫do Principal -->
            <div class="admin-content">
                <!-- Se√ß√£o Dashboard -->
                <div id="section-dashboard" class="content-section" style="display: none;">
                    <!-- Cards de Estat√≠sticas -->
                    <div class="stats-grid">
                        <!-- Card: Total de Clientes -->
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Total Clients</div>
                                    <div class="stat-value" id="totalClients">-</div>
                                    <div class="stat-description">Active codes in system</div>
                                </div>
                                <div class="stat-icon primary">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i>
                                <span>+12% this month</span>
                            </div>
                        </div>

                        <!-- Card: Produtos Dispon√≠veis -->
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Available Products</div>
                                    <div class="stat-value" id="availableProducts">-</div>
                                    <div class="stat-description">Photos ready for sale</div>
                                </div>
                                <div class="stat-icon success">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i>
                                <span>+5% this week</span>
                            </div>
                        </div>

                        <!-- Card: Produtos Reservados -->
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Reserved Products</div>
                                    <div class="stat-value" id="reservedProducts">-</div>
                                    <div class="stat-description">In active carts</div>
                                </div>
                                <div class="stat-icon warning">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-minus"></i>
                                <span>Stable</span>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela: √öltimas Sele√ß√µes -->
                    <div class="data-table-container">
                        <div class="table-header">
                            <h3 class="table-title">Recent Selections</h3>
                            <div class="table-actions">
                                <button class="btn btn-secondary">
                                    <i class="fas fa-download"></i>
                                    Export
                                </button>
                                <button class="btn btn-primary">
                                    <i class="fas fa-plus"></i>
                                    New Selection
                                </button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Code</th>
                                    <th>Items</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="recentSelectionsTable">
                                <!-- Dados ser√£o carregados via JavaScript -->
                                <tr>
                                    <td colspan="6" class="text-center">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        Loading data...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Tabela: Produtos Mais Reservados -->
                    <div class="data-table-container">
                        <div class="table-header">
                            <h3 class="table-title">Most Reserved Products</h3>
                            <div class="table-actions">
                                <button class="btn btn-secondary">
                                    <i class="fas fa-filter"></i>
                                    Filter
                                </button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Photo</th>
                                    <th>Category</th>
                                    <th>Reservations</th>
                                    <th>Last Reservation</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="popularProductsTable">
                                <!-- Dados ser√£o carregados via JavaScript -->
                                <tr>
                                    <td colspan="5" class="text-center">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        Loading products...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Se√ß√£o Clientes (Hidden por padr√£o) -->
                <div id="section-clients" class="content-section active">
                    <!-- Loading inicial elegante -->
                    <div id="clientsInitialLoading" class="luxury-loading">
                        <div class="luxury-loading-spinner"></div>
                        <div class="luxury-loading-text">Loading client management...</div>
                    </div>
                </div>

                <div id="section-pricing" class="content-section" style="display: none;">
                    <!-- Container Card para o Header (IGUAL AO SELECTION) -->
                    <div class="section-header-card">
                        <div class="selections-section-header">
                            <h2 class="selections-title">
                                <i class="fas fa-dollar-sign"></i>
                                Price Management
                                <span class="pricing-stats-inline" id="pricingStatsInline">
                                    <span class="stat-separator">|</span>
                                    <span id="inlineTotalCount">-</span> categories
                                    (<span id="inlinePricedCount" class="stat-success">-</span> priced,
                                    <span id="inlineNeedPriceCount" class="stat-warning">-</span> need pricing)
                                </span>
                            </h2>
                            <div class="selections-actions">
                                <span id="pricingModifiedIndicator" class="modified-indicator" style="display: none;">
                                    <i class="fas fa-exclamation-circle"></i>
                                    <span id="pricingModifiedCount">0</span> modified
                                </span>
                                <button id="btnDiscardChanges" class="btn btn-secondary" style="display: none;">
                                    <i class="fas fa-undo"></i>
                                    Discard
                                </button>
                                <button id="btnSaveAllChanges" class="btn btn-success" style="display: none;">
                                    <i class="fas fa-save"></i>
                                    Save Changes
                                </button>
                                <button id="btnSyncDrive" class="btn btn-primary">
                                    <i class="fas fa-sync-alt"></i>
                                    Refresh from R2
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Loading de Sincroniza√ß√£o Localizado -->
                    <div id="pricingSyncLoading" class="pricing-sync-loading" style="display: none;">
                        <div class="sync-loading-overlay"></div>
                        <div class="sync-loading-content">
                            <div class="sync-loading-spinner">
                                <i class="fas fa-sync-alt fa-spin"></i>
                            </div>
                            <h3 class="sync-loading-title">Updating Categories</h3>
                            <p class="sync-loading-message">
                                Please wait while we refresh the category list.
                                This ensures accurate pricing and inventory management.<br>
                                <strong>This may take a few minutes. You can switch tabs and return later.</strong>
                            </p>
                            <div class="sync-loading-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="syncProgressBar"></div>
                                </div>
                                <span class="progress-text" id="syncProgressText">Initializing...</span>
                            </div>
                            <small class="sync-loading-info">
                                <i class="fas fa-info-circle"></i>
                                Automatic sync runs every 2 hours between 7 AM - 6 PM EST
                            </small>
                        </div>
                    </div>

                    <!-- Filtros (mant√©m como est√°) -->
                    <div class="pricing-filters">
                        <div class="filters-row">
                            <div class="filter-group">
                                <label class="filter-label">Search Category</label>
                                <input type="text" id="searchCategories" class="filter-input"
                                    placeholder="Category name or QBITEM...">
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">Price Status</label>
                                <select id="filterPriceStatus" class="filter-select">
                                    <option value="all">All</option>
                                    <option value="with">With Price</option>
                                    <option value="without">Without Price</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">Sort by</label>
                                <select id="sortCategories" class="filter-select">
                                    <option value="name">Name A-Z</option>
                                    <option value="price-high">Highest Price</option>
                                    <option value="price-low">Lowest Price</option>
                                    <option value="photos">Most Photos</option>
                                </select>
                            </div>
                            <button id="btnApplyPricingFilters" class="btn-filter">
                                <i class="fas fa-filter"></i>
                                Filter
                            </button>
                        </div>
                    </div>

                    <!-- ===== INTERFACE TIPO PDF (substitui tabela) ===== -->
                    <div id="pricingConfigContainer" class="pricing-config-container">
                        <!-- Loading inicial -->
                        <div class="pricing-config-loading" id="pricingConfigLoading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading categories...</p>
                        </div>

                        <!-- Container da interface (preenchido via JS) -->
                        <div id="pricingConfigContent" class="pricing-config-content" style="display: none;">
                            <!-- Ser√° preenchido por renderGroupedCategories() -->
                        </div>
                    </div>
                </div>

                <!-- ===== MODAL PARA EDITAR QB ITEM ===== -->
                <div id="qbItemModal" class="price-modal" style="display: none;">
                    <div class="price-modal-overlay" onclick="adminPricing.closeQBItemModal()"></div>
                    <div class="price-modal-content" style="max-width: 500px;">
                        <div class="price-modal-header">
                            <h3 class="modal-title">
                                <i class="fas fa-qrcode"></i>
                                <span>Edit QB Item Code</span>
                            </h3>
                            <button class="modal-close" onclick="adminPricing.closeQBItemModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>

                        <div class="price-modal-body">
                            <div class="form-group">
                                <label class="form-label">QB Item Code</label>
                                <input type="text" id="qbItemModalInput" class="form-input"
                                    placeholder="Enter QB Item code (e.g., 5475BR)">
                                <small class="text-muted">This code will be used for QuickBooks integration</small>
                            </div>
                        </div>

                        <div class="price-modal-footer">
                            <button type="button" class="btn btn-secondary" onclick="adminPricing.closeQBItemModal()">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                            <button type="button" class="btn btn-primary" onclick="adminPricing.saveQBItemFromModal()">
                                <i class="fas fa-save"></i> Save QB Item
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ===== MODAL DE PRE√áOS REDESENHADO ===== -->
                <div id="priceModal" class="price-modal" style="display: none;">
                    <div class="price-modal-overlay" onclick="adminPricing.closePriceModal()"></div>
                    <div class="price-modal-content" style="max-width: 600px;">
                        <div class="price-modal-header">
                            <h3 class="modal-title">
                                <i class="fas fa-dollar-sign"></i>
                                <span id="priceModalTitle">Set Base Price</span>
                            </h3>
                            <button class="modal-close" onclick="adminPricing.closePriceModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>

                        <div class="price-modal-body">
                            <!-- Info da Categoria -->
                            <div class="price-modal-header-info">
                                <h3 id="modalCategoryName">Category Name</h3>
                                <div class="category-stats">
                                    <div class="stat-item">
                                        <i class="fas fa-images"></i>
                                        <span id="modalPhotoCount">0 photos</span>
                                    </div>
                                    <div class="stat-item">
                                        <i class="fas fa-dollar-sign"></i>
                                        <span id="modalCurrentPrice">Current: $0.00</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Base Price ONLY -->
                            <div class="pricing-section">
                                <div class="form-group">
                                    <label class="form-label" for="newPrice">
                                        <i class="fas fa-dollar-sign"></i>
                                        Base Price
                                    </label>
                                    <input type="number" id="newPrice" class="form-input" min="0" step="0.01"
                                        placeholder="109.00" required>
                                    <small class="form-hint">
                                        Standard price for this category (when not in Mix & Match)
                                    </small>
                                </div>
                            </div>

                            <!-- Info sobre Mix & Match -->
                            <div class="bulk-edit-info" style="margin-top: 20px;">
                                <i class="fas fa-info-circle"></i>
                                <span>To configure volume tiers, use the <strong>Bulk Edit</strong> button</span>
                            </div>
                        </div>

                        <div class="price-modal-footer">
                            <button type="button" class="btn btn-secondary" onclick="adminPricing.closePriceModal()">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                            <button type="button" class="btn btn-primary" onclick="adminPricing.saveBasePrice()">
                                <i class="fas fa-check"></i> Save Price
                            </button>
                        </div>
                    </div>
                </div>


                <!-- ===== MODAL PARA GERENCIAR VOLUME DISCOUNTS ===== -->
                <div id="volumeRulesModal" class="price-modal" style="display: none;">
                    <div class="price-modal-overlay" onclick="this.parentElement.style.display='none'"></div>
                    <div class="price-modal-content" style="max-width: 600px;">
                        <div class="price-modal-header">
                            <h3 class="modal-title">
                                <i class="fas fa-dollar-sign"></i>
                                <span>Manage Volume Discounts</span>
                            </h3>
                            <button class="modal-close" onclick="adminPricing.closeVolumeRulesModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>

                        <div class="price-modal-body">
                            <div class="info-box"
                                style="background: rgba(212, 175, 55, 0.1); padding: 1rem; border-radius: 4px; margin-bottom: 1rem;">
                                <p style="margin: 0; color: var(--text-secondary);">
                                    <i class="fas fa-info-circle"></i>
                                    Volume discounts apply automatically to ALL regular clients based on quantity
                                    purchased.
                                </p>
                            </div>

                            <!-- Lista de regras existentes -->
                            <div id="volumeRulesListModal" style="margin-bottom: 1rem;">
                                <!-- Ser√° preenchido via JS -->
                            </div>

                            <!-- Formul√°rio para nova regra -->
                            <div class="add-rule-form"
                                style="background: rgba(255,255,255,0.02); padding: 1rem; border-radius: 4px;">
                                <h5>Add New Volume Rule</h5>
                                <div class="form-row">
                                    <div class="form-group" style="flex: 1;">
                                        <label>From (photos)</label>
                                        <input type="number" id="volumeMinQty" min="1" class="form-input"
                                            placeholder="10">
                                    </div>
                                    <div class="form-group" style="flex: 1;">
                                        <label>To (photos)</label>
                                        <input type="number" id="volumeMaxQty" min="1" class="form-input"
                                            placeholder="20">
                                        <small>Leave empty for unlimited</small>
                                    </div>
                                    <div class="form-group" style="flex: 1;">
                                        <label>Fixed Price ($)</label>
                                        <input type="number" id="volumePrice" min="0" step="0.01" class="form-input"
                                            placeholder="89.00">
                                    </div>
                                </div>
                                <button type="button" class="btn btn-primary"
                                    onclick="adminPricing.saveVolumeRuleFromModal()"> <i class="fas fa-plus"></i> Add
                                    Rule
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal de Confirma√ß√£o de Delete -->
                <div id="deleteConfirmModal" class="price-modal" style="display: none;">
                    <div class="price-modal-overlay" onclick="adminPricing.cancelDelete()"></div>
                    <div class="price-modal-content" style="max-width: 400px;">
                        <div class="price-modal-header" style="background: rgba(244, 67, 54, 0.1);">
                            <h3 class="modal-title">
                                <i class="fas fa-exclamation-triangle" style="color: #f44336;"></i>
                                <span>Confirm Delete</span>
                            </h3>
                        </div>
                        <div class="price-modal-body" style="text-align: center; padding: 2rem;">
                            <p id="deleteConfirmMessage" style="margin: 0; font-size: 1.1rem;">
                                Remove this quantity rule?
                            </p>
                        </div>
                        <div class="price-modal-footer" style="justify-content: center; gap: 1rem;">
                            <button type="button" class="btn btn-secondary" onclick="adminPricing.cancelDelete()">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                            <button type="button" class="btn btn-danger" onclick="adminPricing.confirmDelete()">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ===== MODAL PARA ADICIONAR CLIENT EXCEPTION ===== -->

                <!-- Modal APENAS para selecionar cliente -->
                <div id="clientSelectModal" class="price-modal" style="display: none;">
                    <div class="price-modal-overlay" onclick="this.parentElement.style.display='none'"></div>
                    <div class="price-modal-content" style="max-width: 400px;">
                        <div class="price-modal-header">
                            <h3 class="modal-title">
                                <i class="fas fa-users"></i>
                                <span>Select Client</span>
                            </h3>
                            <button class="modal-close" onclick="this.parentElement.style.display='none'">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="price-modal-body">
                            <div class="form-group">
                                <label>Choose a client to configure rates:</label>
                                <select id="clientSelectDropdown" class="form-input">
                                    <option value="">Select...</option>
                                </select>
                            </div>
                        </div>
                        <div class="price-modal-footer">
                            <button class="btn btn-secondary"
                                onclick="this.closest('.price-modal').style.display='none'">Cancel</button>
                            <button class="btn btn-primary" onclick="adminPricing.proceedToConfigureRates()">
                                <i class="fas fa-cog"></i> Configure Rates
                            </button>
                        </div>
                    </div>
                </div>

                <div id="clientRuleModal" class="price-modal" style="display: none;">
                    <div class="price-modal-overlay" onclick="this.parentElement.style.display='none'"></div>
                    <div class="price-modal-content" style="max-width: 500px;">
                        <div class="price-modal-header">
                            <h3 class="modal-title">
                                <i class="fas fa-user-tag"></i>
                                <span>Custom Client Rates</span>
                            </h3>
                            <button class="modal-close" onclick="adminPricing.closeClientRuleModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>

                        <div class="price-modal-body">
                            <!-- Mostrar cliente selecionado -->
                            <div class="selected-client-info"
                                style="background: rgba(212, 175, 55, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 20px;">
                                <strong>Configuring rates for:</strong>
                                <span id="selectedClientName" style="color: #d4af37; font-size: 1.1em;">CLIENT
                                    NAME</span>
                            </div>

                            <!-- Lista de faixas existentes para este cliente -->
                            <div id="clientRatesListModal" style="margin-bottom: 1rem;">
                                <!-- Ser√° preenchido quando selecionar cliente -->
                            </div>

                            <!-- Formul√°rio para nova faixa -->
                            <div class="add-rule-form"
                                style="background: rgba(255,255,255,0.02); padding: 1rem; border-radius: 4px; display: none;"
                                id="clientRateForm">
                                <h5>Add Rate Range</h5>
                                <div class="form-row">
                                    <div class="form-group" style="flex: 1;">
                                        <label>From (photos)</label>
                                        <input type="number" id="clientMinQty" min="1" class="form-input"
                                            placeholder="1">
                                    </div>
                                    <div class="form-group" style="flex: 1;">
                                        <label>To (photos)</label>
                                        <input type="number" id="clientMaxQty" min="1" class="form-input"
                                            placeholder="10">
                                        <small>Leave empty for unlimited</small>
                                    </div>
                                    <div class="form-group" style="flex: 1;">
                                        <label>Fixed Price ($)</label>
                                        <input type="number" id="clientPrice" min="0" step="0.01" class="form-input"
                                            placeholder="85.00">
                                    </div>
                                </div>
                                <button type="button" class="btn btn-primary" onclick="adminPricing.saveClientRate()">
                                    <i class="fas fa-plus"></i> Add Range
                                </button>
                            </div>
                        </div>

                        <div class="price-modal-footer">
                            <button type="button" class="btn btn-secondary"
                                onclick="adminPricing.closeClientRuleModal()">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                            <button type="button" class="btn btn-primary" onclick="adminPricing.saveAllClientRates()">
                                <i class="fas fa-check"></i> Done
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ===== BULK EDIT MODAL ===== -->
                <div id="bulkEditModal" class="price-modal" style="display: none;">
                    <div class="price-modal-overlay" onclick="adminPricing.closeBulkEditModal()"></div>
                    <div class="price-modal-content" style="max-width: 1000px;">
                        <div class="price-modal-header">
                            <h3 class="modal-title">
                                <i class="fas fa-edit"></i>
                                <span>Bulk Edit Categories</span>
                            </h3>
                            <button class="modal-close" onclick="adminPricing.closeBulkEditModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>

                        <div class="price-modal-body">
                            <!-- Info de sele√ß√£o -->
                            <div class="bulk-edit-info">
                                <i class="fas fa-info-circle"></i>
                                <span id="bulkSelectedCount">0 categories selected</span>
                            </div>

                            <!-- Mix & Match Toggle -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-layer-group"></i>
                                    Mix & Match Pricing
                                </label>
                                <div class="toggle-container">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="bulkMixMatchEnabled">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <span id="bulkMixMatchLabel" class="toggle-label">Disabled</span>
                                </div>
                                <small class="form-hint">
                                    When enabled, categories participate in global volume pricing
                                </small>
                            </div>

                            <!-- Base Price -->
                            <div class="form-group">
                                <label class="form-label" for="bulkBasePrice">
                                    <i class="fas fa-dollar-sign"></i>
                                    Base Price
                                </label>
                                <input type="number" id="bulkBasePrice" class="form-input" placeholder="109.00" min="0"
                                    step="0.01">
                                <small class="form-hint">Standard price for 1-12 items</small>
                            </div>

                            <!-- Volume Tiers -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-chart-line"></i>
                                    Volume Tiers
                                </label>

                                <div class="volume-tiers-container">
                                    <!-- Tier 1 -->
                                    <div class="volume-tier-row">
                                        <div class="tier-range">
                                            <input type="number" class="tier-input" value="1" readonly>
                                            <span>to</span>
                                            <input type="number" id="bulkTier1Max" class="tier-input" value="12"
                                                min="1">
                                        </div>
                                        <div class="tier-price">
                                            <span>$</span>
                                            <input type="number" id="bulkTier1Price" class="tier-input"
                                                placeholder="109.00" min="0" step="0.01">
                                        </div>
                                    </div>

                                    <!-- Tier 2 -->
                                    <div class="volume-tier-row">
                                        <div class="tier-range">
                                            <input type="number" id="bulkTier2Min" class="tier-input" value="13"
                                                min="1">
                                            <span>to</span>
                                            <input type="number" id="bulkTier2Max" class="tier-input" value="36"
                                                min="1">
                                        </div>
                                        <div class="tier-price">
                                            <span>$</span>
                                            <input type="number" id="bulkTier2Price" class="tier-input"
                                                placeholder="105.00" min="0" step="0.01">
                                        </div>
                                    </div>

                                    <!-- Tier 3 -->
                                    <div class="volume-tier-row">
                                        <div class="tier-range">
                                            <input type="number" id="bulkTier3Min" class="tier-input" value="37"
                                                min="1">
                                            <span>to</span>
                                            <input type="text" class="tier-input" value="‚àû" readonly>
                                        </div>
                                        <div class="tier-price">
                                            <span>$</span>
                                            <input type="number" id="bulkTier3Price" class="tier-input"
                                                placeholder="99.00" min="0" step="0.01">
                                        </div>
                                    </div>
                                </div>

                                <small class="form-hint">
                                    Define pricing based on total quantity purchased
                                </small>
                            </div>
                        </div>

                        <div class="price-modal-footer">
                            <button type="button" class="btn btn-secondary" onclick="adminPricing.closeBulkEditModal()">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                            <button type="button" class="btn btn-primary" onclick="adminPricing.saveBulkEdit()">
                                <i class="fas fa-check"></i> Apply to <span id="bulkApplyCount">0</span> Categories
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ===== SE√á√ÉO SELE√á√ïES (ATUALIZADA) ===== -->
                <div id="section-selections" class="content-section" style="display: none;">
                    <!-- Cabe√ßalho -->
                    <div class="selections-section-header">
                        <h2 class="selections-title">
                            <i class="fas fa-shopping-cart"></i>
                            Selection Management
                        </h2>
                        <div class="selections-actions">
                            <button id="btnRefreshSelections" class="btn btn-secondary">
                                <i class="fas fa-sync-alt"></i>
                                Refresh
                            </button>
                        </div>
                    </div>

                    <!-- Estat√≠sticas R√°pidas -->
                    <div id="selectionStats" class="selection-stats" style="display: block;">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Total Selections</div>
                                        <div class="stat-value" id="totalSelections">-</div>
                                        <div class="stat-description" id="totalSelectionsDescription">All time</div>
                                    </div>
                                    <div class="stat-icon primary">
                                        <i class="fas fa-shopping-cart"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Pending</div>
                                        <div class="stat-value" id="pendingSelections">-</div>
                                        <div class="stat-description" id="pendingSelectionsDescription">Awaiting
                                            approval</div>
                                    </div>
                                    <div class="stat-icon warning">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">SOLD PHOTOS</div>
                                        <div class="stat-value" id="thisMonthSelections">-</div>
                                        <div class="stat-description">All time</div>
                                    </div>
                                    <div class="stat-icon success">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Filtros -->
                    <div class="selections-filters">
                        <div class="filters-row">
                            <div class="filter-group">
                                <label class="filter-label">Status</label>
                                <select id="filterSelectionStatus" class="filter-select">
                                    <option value="all">üìã All Status</option>
                                    <option value="pending">üïê Pending</option>
                                    <option value="cancelled">‚ùå Cancelled</option>
                                    <option value="finalized">‚úÖ Sold</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label class="filter-label">Search Client</label>
                                <input type="text" id="searchSelectionClient" class="filter-input"
                                    placeholder="Code or client name...">
                            </div>
                            <button id="btnApplySelectionFilters" class="btn-filter">
                                <i class="fas fa-filter"></i>
                                Filter
                            </button>
                        </div>
                    </div>

                    <!-- Tabela de Sele√ß√µes -->
                    <div class="selections-table-container">
                        <table class="selections-table">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Company</th>
                                    <th>Sales Rep</th>
                                    <th>Items</th>
                                    <th>Total Value</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="selectionsTableBody">
                                <tr>
                                    <td colspan="8" class="text-center">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        Loading selections...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- Pagina√ß√£o das Sele√ß√µes -->
                        <div id="selectionsPagination" class="pricing-pagination"
                            style="display: flex; margin-top: 20px;">
                            <button id="btnPrevPageSel" class="btn btn-secondary"
                                onclick="adminSelections.goToPage(adminSelections.currentPage - 1)">
                                <i class="fas fa-chevron-left"></i>
                                Previous
                            </button>

                            <div id="paginationNumbersSel" class="pagination-numbers"
                                style="display: flex; gap: 5px; margin: 0 15px;">
                                <!-- N√∫meros aqui -->
                            </div>

                            <button id="btnNextPageSel" class="btn btn-secondary"
                                onclick="adminSelections.goToPage(adminSelections.currentPage + 1)">
                                Next
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Se√ß√£o Relat√≥rios (Hidden por padr√£o) -->
                <div id="section-reports" class="content-section" style="display: none;">
                    <h2>Reports - In Development</h2>
                    <p>This section will be implemented in the next phase.</p>
                </div>

                <!-- Se√ß√£o Storage Management -->
                <div id="section-storage" class="content-section" style="display: none;">
                    <!-- Container Card Principal (igual Special Selections) -->
                    <div class="section-header-card">
                        <div class="selections-section-header">
                            <h2 class="selections-title">
                                <i class="fas fa-cloud-upload-alt"></i>
                                Storage Management
                            </h2>
                            <div class="selections-actions">
                                <button class="btn btn-secondary" onclick="window.storageManager?.checkStatus()">
                                    <i class="fas fa-sync-alt"></i>
                                    Refresh
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="selection-stats" style="display: block;">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Storage Mode</div>
                                        <div class="stat-value" id="storageMode">Loading...</div>
                                        <div class="stat-description">Current storage system</div>
                                    </div>
                                    <div class="stat-icon primary">
                                        <i class="fas fa-database"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Storage URL</div>
                                        <div class="stat-value" id="storageUrl">Checking...</div>
                                        <div class="stat-description">Active endpoint</div>
                                    </div>
                                    <div class="stat-icon success">
                                        <i class="fas fa-link"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-header">
                                    <div>
                                        <div class="stat-title">Files in R2</div>
                                        <div class="stat-value" id="fileCount">0</div>
                                        <div class="stat-description">Total uploaded files</div>
                                    </div>
                                    <div class="stat-icon secondary">
                                        <i class="fas fa-images"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Upload Section (com card container) -->
                    <div class="pricing-table-container" style="margin-top: 20px;">
                        <div class="table-header">
                            <h3 class="table-title">
                                <i class="fas fa-upload"></i>
                                Upload Photos
                            </h3>
                        </div>

                        <div style="padding: 20px;">
                            <div class="upload-zone" id="uploadZone">
                                <h3>üì§ Drag photos here or click to select</h3>
                                <p>Accepted formats: JPG, PNG, WebP (max 10MB)</p>
                                <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
                            </div>

                            <div class="folder-input-group">
                                <label>üìÅ Destination folder:</label>
                                <input type="text" id="folderPath" class="filter-input" placeholder="e.g.: brazil/large"
                                    style="max-width: 400px;">
                            </div>

                            <div class="files-preview" id="filesPreview"></div>

                            <div class="upload-actions">
                                <button class="btn btn-primary" id="uploadBtn" disabled>
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    Select files
                                </button>
                            </div>

                            <div class="upload-results" id="uploadResults"></div>
                        </div>
                    </div>
                </div>

                <!-- Se√ß√£o Configura√ß√µes (Hidden por padr√£o) -->
                <div id="section-settings" class="content-section">
                    <!-- Loading -->
                    <div id="configLoading" class="loading-section">
                        <div class="loading-spinner">
                            <i class="fas fa-spinner fa-spin fa-2x"></i>
                        </div>
                        <p>Loading settings...</p>
                    </div>

                    <!-- Erro -->
                    <div id="configError" class="error-section" style="display: none;">
                        <div class="error-content">
                            <i class="fas fa-exclamation-triangle fa-2x"></i>
                            <h3>Error Loading Settings</h3>
                            <p id="errorMessage">Unknown error</p>
                            <button onclick="location.reload()" class="btn btn-primary">
                                <i class="fas fa-sync"></i>
                                Try Again
                            </button>
                        </div>
                    </div>

                    <!-- Conte√∫do Principal -->
                    <div id="configContent" style="display: none;">
                        <!-- Cabe√ßalho -->
                        <div class="config-header">
                            <h2 class="config-title">
                                <i class="fas fa-cog"></i>
                                System Settings
                            </h2>
                            <p class="config-description">
                                Configure email and notification settings for the system
                            </p>
                        </div>

                        <!-- Estat√≠sticas -->
                        <div class="config-stats">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-header">
                                        <div>
                                            <div class="stat-title">Emails Sent</div>
                                            <div class="stat-value" id="totalEmailsSent">-</div>
                                            <div class="stat-description">Total notifications</div>
                                        </div>
                                        <div class="stat-icon primary">
                                            <i class="fas fa-envelope"></i>
                                        </div>
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-header">
                                        <div>
                                            <div class="stat-title">Last Email</div>
                                            <div class="stat-value" id="lastEmailSent">-</div>
                                            <div class="stat-description">Date of last email</div>
                                        </div>
                                        <div class="stat-icon success">
                                            <i class="fas fa-clock"></i>
                                        </div>
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-header">
                                        <div>
                                            <div class="stat-title">Configuration Status</div>
                                            <div class="stat-value" id="configStatus">-</div>
                                            <div class="stat-description">Current state</div>
                                        </div>
                                        <div class="stat-icon warning">
                                            <i class="fas fa-cog"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Configura√ß√£o SMTP -->
                        <div class="config-section">
                            <div class="config-section-header">
                                <h3>
                                    <i class="fas fa-server"></i>
                                    SMTP Configuration
                                </h3>
                                <p>Configure email server for sending notifications</p>
                            </div>

                            <form id="smtpConfigForm" class="config-form">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label class="form-label">SMTP Server</label>
                                        <input type="text" id="smtpHost" name="host" class="form-input"
                                            placeholder="smtp.gmail.com" required>
                                        <small class="form-help">Ex: smtp.gmail.com, smtp.outlook.com</small>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Port</label>
                                        <input type="number" id="smtpPort" name="port" class="form-input"
                                            placeholder="587" value="587" required>
                                        <small class="form-help">Default: 587 (STARTTLS)</small>
                                    </div>
                                </div>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label class="form-label">Sender Email</label>
                                        <input type="email" id="smtpUser" name="user" class="form-input"
                                            placeholder="system@sunshine.com" required>
                                        <small class="form-help">Email that will be used to send</small>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Email Password</label>
                                        <input type="password" id="smtpPass" name="pass" class="form-input"
                                            placeholder="********" required>
                                        <small class="form-help">Use app password for Gmail</small>
                                    </div>
                                </div>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label class="form-label">Sender Name</label>
                                        <input type="text" id="senderName" name="senderName" class="form-input"
                                            placeholder="Sunshine Cowhides" required>
                                        <small class="form-help">Name that appears in email</small>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Reply Email</label>
                                        <input type="email" id="senderEmail" name="senderEmail" class="form-input"
                                            placeholder="noreply@sunshine.com" required>
                                        <small class="form-help">Reply email (can be the same)</small>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="button" onclick="testConnection()" class="btn btn-secondary">
                                        <i class="fas fa-plug"></i>
                                        Test Connection
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i>
                                        Save Configuration
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Teste de Email -->
                        <div class="config-section">
                            <div class="config-section-header">
                                <h3>
                                    <i class="fas fa-paper-plane"></i>
                                    Email Test
                                </h3>
                                <p>Send a test email to verify it's working</p>
                            </div>

                            <div class="test-email-form">
                                <div class="form-group">
                                    <label class="form-label">Test Email</label>
                                    <div class="input-group">
                                        <input type="email" id="testEmail" class="form-input"
                                            placeholder="youremail@test.com">
                                        <button type="button" onclick="sendTestEmail()" class="btn btn-primary">
                                            <i class="fas fa-paper-plane"></i>
                                            Send Test
                                        </button>
                                    </div>
                                    <small class="form-help">Enter an email to send a test</small>
                                </div>
                            </div>
                        </div>

                        <!-- Destinat√°rios das Notifica√ß√µes -->
                        <div class="config-section">
                            <div class="config-section-header">
                                <h3>
                                    <i class="fas fa-users"></i>
                                    Notification Recipients
                                </h3>
                                <p>Configure who receives emails when clients finalize selections</p>
                            </div>

                            <!-- Lista de Destinat√°rios -->
                            <div class="recipients-section">
                                <h4>Current Recipients</h4>
                                <div id="recipientsList" class="recipients-list">
                                    <p class="no-recipients">No recipients configured</p>
                                </div>
                            </div>

                            <!-- Adicionar Destinat√°rio -->
                            <div class="add-recipient-section">
                                <h4>Add New Recipient</h4>
                                <div class="add-recipient-form">
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label class="form-label">Name</label>
                                            <input type="text" id="newRecipientName" class="form-input"
                                                placeholder="John Silva">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Email</label>
                                            <input type="email" id="newRecipientEmail" class="form-input"
                                                placeholder="john@sunshine.com">
                                        </div>
                                    </div>
                                    <button type="button" onclick="addRecipient('newSelection')"
                                        class="btn btn-success">
                                        <i class="fas fa-plus"></i>
                                        Add Recipient
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NOVA SE√á√ÉO: SPECIAL SELECTIONS -->
                <div id="section-special-selections" class="content-section" style="display: none;">
                    <!-- Loading inicial -->
                    <div id="specialSelectionsLoading" class="loading-section">
                        <div class="loading-spinner">
                            <i class="fas fa-spinner fa-spin fa-2x"></i>
                        </div>
                        <p>Loading special selections...</p>
                    </div>

                    <!-- Erro de carregamento -->
                    <div id="specialSelectionsError" class="error-section" style="display: none;">
                        <div class="error-content">
                            <i class="fas fa-exclamation-triangle fa-2x"></i>
                            <h3>Error loading special selections</h3>
                            <p id="specialSelectionsErrorMessage">Unable to load special selections data.</p>
                            <button onclick="window.adminSpecialSelections?.init()" class="btn btn-primary">
                                <i class="fas fa-redo"></i> Try again
                            </button>
                        </div>
                    </div>

                    <!-- Conte√∫do principal (ser√° criado via JavaScript) -->
                    <div id="specialSelectionsContent" style="display: none;">
                        <!-- Ser√° preenchido pelo JavaScript -->
                    </div>
                </div>

                <!-- INVENTORY MONITOR SECTION -->
                <div id="section-inventoryMonitor" class="content-section" style="display: none;">
                    <div class="section-header-card">
                        <button id="scanBtn" onclick="monitor.scan()"
                            style="padding: 8px; border-radius: 8px; color: #000000; font: normal 12pt Arial; font-weight: 600; margin-bottom: 15px; background: #d4af37; border: none; cursor: pointer;">
                            <i class="fas fa-search"></i> Scan Now
                        </button>
                        <span id="scanStatus" style="margin-left: 10px; color: #666;"></span>
                        <h2 style="margin-top: 15px;">üìä Inventory Status Monitor</h2>
                        <p>Real-time synchronization check between CDE and MongoDB</p>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-container"
                        style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Total Scanned</div>
                                    <div class="stat-value" id="totalScanned">-</div>
                                    <div class="stat-description">Photos checked</div>
                                </div>
                                <div class="stat-icon primary">
                                    <i class="fas fa-images"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Discrepancies</div>
                                    <div class="stat-value" id="totalDiscrepancies">-</div>
                                    <div class="stat-description">Issues found</div>
                                </div>
                                <div class="stat-icon warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Critical</div>
                                    <div class="stat-value" id="criticalCount" style="color: #b72424e0;">-</div>
                                    <div class="stat-description">Sold appearing available</div>
                                </div>
                                <div class="stat-icon danger" style="color: black; background-color: #b72424e0;">
                                    <i class="fas fa-times-circle"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Medium</div>
                                    <div class="stat-value" id="mediumCount" style="color: #ffc107;">-</div>
                                    <div class="stat-description">Status conflicts</div>
                                </div>
                                <div class="stat-icon warning">
                                    <i class="fas fa-exclamation"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Warnings</div>
                                    <div class="stat-value" id="warningCount" style="color: #ffc107;">-</div>
                                    <div class="stat-description">QB Item missing</div>
                                </div>
                                <div class="stat-icon info" style="color: #000000; background: #d4af37;">
                                    <i class="fas fa-info-circle"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Discrepancies Table -->
                    <div class="data-table-container">
                        <div class="table-header">
                            <h3 class="table-title">Discrepancies Found</h3>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Photo</th>
                                    <th>CDE Status</th>
                                    <th>Gallery Status</th>
                                    <th>QB Item (CDE)</th>
                                    <th>Severity</th>
                                    <th>Issue</th>
                                </tr>
                            </thead>
                            <tbody id="discrepanciesTable">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px; color: #999;">
                                        Click "Scan Now" to check inventory status
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- ============================================ -->
                <!-- SE√á√ÉO EMAIL MARKETING -->
                <!-- ============================================ -->
                <div id="section-marketing" class="content-section" style="display: none;">
                    <div class="section-header" style="margin-bottom: 30px;">
                        <h2 style="font-size: 28px; color: #ffffff; margin-bottom: 10px;">
                            üìß Email Marketing
                        </h2>
                        <p style="color: #ffffff; font-size: 16px;">
                            Send marketing emails to notify clients about new products
                        </p>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Total Recipients</div>
                                    <div class="stat-value" id="marketingRecipientsCount" style="color: #28a745;">-
                                    </div>
                                    <div class="stat-description">Clients with email registered</div>
                                </div>
                                <div class="stat-icon success">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Clients missing email address</div>
                                    <div class="stat-value" id="marketingWithoutEmail" style="color: #dc3545;">-</div>
                                    <div class="stat-description">Please add their emails in Client Management</div>
                                </div>
                                <div class="stat-icon" style="background: #dc3545; color: white;">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Emails Sent</div>
                                    <div class="stat-value" id="marketingTotalSent" style="color: #D4AF37;">-</div>
                                    <div class="stat-description">Emails can be sent again after 24 hours to prevent blocking</div>
                                </div>
                                <div class="stat-icon primary">
                                    <i class="fas fa-paper-plane"></i>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div>
                                    <div class="stat-title">Last Email Sent</div>
                                    <div class="stat-value" id="marketingLastSent"
                                        style="color: #6c757d; font-size: 18px;">Never</div>
                                    <div class="stat-description">Most recent campaign</div>
                                </div>
                                <div class="stat-icon info" style="color: #000000; background: #d4af37;">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Recipients List -->
                    <div class="data-table-container" style="margin-bottom: 30px;">
                        <div class="table-header">
                            <h3 class="table-title">
                                <i class="fas fa-users"></i> Email Recipients Preview
                            </h3>
                            <button id="loadRecipientsBtn" class="btn btn-secondary" onclick="loadRecipientsList()"
                                style="background: #6c757d; padding: 8px 16px;">
                                <i class="fas fa-list"></i> View First 50 Clients
                            </button>
                        </div>

                        <div id="recipientsListContainer" style="padding: 20px; display: none;">
                            <!-- Loading -->
                            <div id="recipientsListLoading" style="text-align: center; padding: 40px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 32px; color: #D4AF37;"></i>
                                <p style="margin-top: 15px; color: #666;">Loading recipients...</p>
                            </div>

                            <!-- List -->
                            <div id="recipientsListContent" style="display: none;">
                                <div
                                    style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #2196F3;">
                                    <p style="margin: 0; color: #1976D2;">
                                        <i class="fas fa-info-circle"></i>
                                        <strong>Showing first 50 clients with registered email addresses.</strong>
                                        Review this list before sending your campaign to ensure accuracy.
                                    </p>
                                </div>

                                <div
                                    style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px;">
                                    <table class="data-table" style="margin: 0;">
                                        <thead style="position: sticky; top: 0; background: #f8f9fa; z-index: 1;">
                                            <tr
                                                style="background: rgb(81 79 75); font-weight: 600; color: #ffffff; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid rgb(255 255 255 / 20%);">
                                                <th style="width: 60px;">Code</th>
                                                <th>Client Name</th>
                                                <th>Email</th>
                                                <th>Company</th>
                                            </tr>
                                        </thead>
                                        <tbody id="recipientsTableBody" style="color: white;">
                                            <!-- Will be populated by JS -->
                                        </tbody>
                                    </table>
                                </div>

                                <div
                                    style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                                    <span style="color: #666; font-size: 14px;">
                                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                                        Showing <strong id="recipientsShowingCount">0</strong> of <strong
                                            id="recipientsTotalCount">0</strong> clients with email
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Email Composer -->
                    <div class="data-table-container" style="margin-bottom: 30px;">
                        <div class="table-header">
                            <h3 class="table-title">
                                <i class="fas fa-edit"></i> Compose Marketing Email
                            </h3>
                        </div>

                        <div style="padding: 30px;">
                            <!-- Subject Field -->
                            <div class="form-group" style="margin-bottom: 25px;">
                                <label
                                    style="display: block; margin-bottom: 10px; font-weight: 600; font-size: 15px; color: #ffffff;">
                                    Subject Line:
                                </label>
                                <input type="text" id="marketingEmailSubject" class="form-input"
                                    value="üêÆ New Premium Cowhides Just Arrived at Sunshine Gallery!"
                                    style="width: 100%; padding: 14px; border: 2px solid #ddd; border-radius: 8px; font-size: 15px; transition: border-color 0.3s;"
                                    onfocus="this.style.borderColor='#D4AF37'" onblur="this.style.borderColor='#ddd'">
                            </div>

                            <!-- Message Field -->
                            <div class="form-group" style="margin-bottom: 25px;">
                                <label
                                    style="display: block; margin-bottom: 10px; font-weight: 600; font-size: 15px; color: #ffffff;">
                                    Message:
                                </label>
                                <textarea id="marketingEmailMessage" rows="10" class="form-input"
                                    placeholder="Enter your marketing message here..."
                                    style="width: 100%; padding: 14px; border: 2px solid #ddd; border-radius: 8px; resize: vertical; font-size: 15px; line-height: 1.6; font-family: Arial, sans-serif; transition: border-color 0.3s;"
                                    onfocus="this.style.borderColor='#D4AF37'"
                                    onblur="this.style.borderColor='#ddd'">We're excited to announce that our latest collection of premium cowhides has just arrived at Sunshine Gallery!

Each cowhide is ONE-OF-A-KIND and completely unique. Don't miss your chance to secure the perfect pieces for your business!</textarea>
                                <small style="color: #ffffff; display: block; margin-top: 8px;">
                                    <i class="fas fa-info-circle"></i>
                                    <strong>Personalization:</strong> Each email will include the client's name and
                                    their unique access code.
                                </small>
                            </div>

                            <!-- Preview Button -->
                            <div style="margin-bottom: 25px;">
                                <button id="marketingPreviewBtn" class="btn btn-secondary"
                                    style="padding: 12px 24px; font-size: 15px;" onclick="generateEmailPreview()">
                                    <i class="fas fa-eye"></i> Preview Email
                                </button>
                            </div>

                            <!-- Preview Area -->
                            <div id="marketingPreviewArea" style="display: none; margin-bottom: 30px;">
                                <div
                                    style="background: #f8f9fa; border: 2px solid #D4AF37; border-radius: 8px; padding: 20px;">
                                    <h4
                                        style="margin: 0 0 15px 0; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-desktop"></i> Email Preview
                                    </h4>
                                    <div id="marketingPreviewContent"
                                        style="background: #e3e3e3; border-radius: 4px; padding: 20px; max-height: 600px; overflow-y: auto;">
                                        <!-- Preview HTML will be inserted here -->
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div style="display: flex; gap: 15px; border-top: 2px solid #eee; padding-top: 25px; flex-wrap: wrap; justify-content: space-around"
                                ;>
                                <!-- Test Email Section -->
                                <div
                                    style="background: rgba(212, 175, 55, 0.05); border: 2px solid #ffffff; border-radius: 8px; padding: 20px; margin-bottom: 0px;">
                                    <h4
                                        style="margin: 0 0 15px 0; color: #ffffff; display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-flask"></i> Send Test Email
                                    </h4>
                                    <div style="display: flex; gap: 15px; align-items: flex-end; flex-wrap: wrap;">
                                        <div style="flex: 1; min-width: 250px;">
                                            <label
                                                style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff; font-size: 14px;">
                                                Test Email Address:
                                            </label>
                                            <input type="email" id="marketingTestEmail" class="form-input"
                                                placeholder="Enter email to receive test"
                                                style="width: 100%; padding: 12px; border: 2px solid #ffffff; border-radius: 6px; font-size: 15px;">
                                        </div>
                                        <button id="marketingSendTestBtn" class="btn btn-primary"
                                            style="background: #d4af37; padding: 12px 28px; font-size: 15px; min-width: 200px; height: 48px;"
                                            onclick="sendTestEmail()">
                                            <i class="fas fa-paper-plane"></i> Send Test
                                        </button>
                                    </div>
                                    <small style="display: block; margin-top: 10px; color: #ffffff;">
                                        <i class="fas fa-info-circle"></i> Enter any email address to preview how
                                        clients will receive the campaign
                                    </small>
                                </div>

                                <!-- Send Campaign Button -->
                                <div
                                    style="background: linear-gradient(135deg, #D4AF37 0%, #C5A028 100%); border-radius: 8px; padding: 10px; margin-bottom: 0px; text-align: left; box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3); border: solid 2pt white;">
                                    <div style="margin-bottom: 20px;">
                                        <i class="fas fa-paper-plane"
                                            style="font-size: 30px; color: white; margin-bottom: 15px;"></i>
                                        <h3
                                            style="margin: 0 0 10px 0; color: white; font-size: 24px; font-weight: bold;">
                                            Ready to Send Campaign?
                                        </h3>
                                        <p style="margin: 0; color: white; opacity: 0.95; font-size: 16px;">
                                            This will send your marketing email to all <strong
                                                id="marketingFinalCount">279</strong> clients with registered email
                                            addresses
                                        </p>
                                    </div>

                                    <button id="marketingSendAllBtn" class="btn btn-primary"
                                        style="background: white; color: #D4AF37; padding: 12px 40px; font-size: 18px; font-weight: bold; border: none; box-shadow: 0 4px 8px rgba(0,0,0,0.2); transition: transform 0.2s;"
                                        onmouseover="this.style.transform='translateY(-2px)'"
                                        onmouseout="this.style.transform='translateY(0)'" onclick="confirmSendToAll()">
                                        <i class="fas fa-rocket"></i> Send to All Clients Now
                                    </button>

                                    <p style="margin: 15px 0 0 0; color: white; opacity: 0.8; font-size: 13px;">
                                        <i class="fas fa-shield-alt"></i> You will be asked to confirm before sending
                                    </p>
                                </div>
                            </div>

                            <!-- Status Messages -->
                            <div id="marketingStatus" style="margin-top: 25px; display: none;">
                                <!-- Status messages will appear here -->
                            </div>

                            <!-- Loading Overlay -->
                            <div id="marketingLoadingOverlay"
                                style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 9999; justify-content: center; align-items: center;">
                                <div
                                    style="background: white; padding: 40px; border-radius: 12px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                                    <div
                                        style="width: 60px; height: 60px; border: 5px solid #f3f3f3; border-top: 5px solid #D4AF37; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;">
                                    </div>
                                    <h3 style="margin: 0 0 10px 0; color: #2c3e50; font-size: 20px;"
                                        id="marketingLoadingTitle">Sending Email...</h3>
                                    <p style="margin: 0; color: #666; font-size: 14px;" id="marketingLoadingText">Please
                                        wait...</p>
                                </div>
                            </div>

                            <style>
                                @keyframes spin {
                                    0% {
                                        transform: rotate(0deg);
                                    }

                                    100% {
                                        transform: rotate(360deg);
                                    }
                                }
                            </style>
                        </div>
                    </div>

                    <!-- Instructions -->
                    <div class="data-table-container">
                        <div class="table-header">
                            <h3 class="table-title">
                                <i class="fas fa-question-circle"></i> How to Use
                            </h3>
                        </div>
                        <div style="padding: 25px;">
                            <div
                                style="background: #e3f2fd; border-left: 4px solid #2196F3; padding: 20px; border-radius: 4px; margin-bottom: 15px;">
                                <h4 style="margin: 0 0 10px 0; color: #1976D2;">
                                    <i class="fas fa-lightbulb"></i> Email Personalization
                                </h4>
                                <p style="margin: 0; line-height: 1.6; color: #555;">
                                    Each email is automatically personalized with:
                                </p>
                                <ul style="margin: 10px 0 0 20px; color: #555;">
                                    <li><strong>Client Name:</strong> "Hello [Client Name]!"</li>
                                    <li><strong>Access Code:</strong> Displayed in the email</li>
                                    <li><strong>Direct Link:</strong> Button to access the gallery</li>
                                </ul>
                            </div>

                            <div
                                style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 20px; border-radius: 4px;">
                                <h4 style="margin: 0 0 10px 0; color: #856404;">
                                    <i class="fas fa-exclamation-triangle"></i> Important Notes
                                </h4>
                                <ul style="margin: 10px 0 0 20px; color: #856404; line-height: 1.8;">
                                    <li>Always send a <strong>test email</strong> first to verify content and formatting
                                    </li>
                                    <li>Only clients with registered email addresses will receive the campaign</li>
                                    <li>Emails are sent in batches to avoid spam filters (5 per batch, 2-second delay)
                                    </li>
                                    <li>Check the "Total Recipients" card to see how many clients will receive the email
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- FIM SE√á√ÉO EMAIL MARKETING -->
            </div>
        </main>
    </div>

    <!-- Modal de Confirma√ß√£o para Mudan√ßas N√£o Salvas -->
    <div id="unsavedChangesModal" class="confirmation-modal" style="display: none;">
        <div class="confirmation-overlay"></div>
        <div class="confirmation-content">
            <div class="confirmation-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3>Unsaved Changes</h3>
            <p>You have unsaved changes. Are you sure you want to close without saving?</p>
            <div class="confirmation-buttons">
                <button class="btn-cancel" onclick="adminPricing.cancelClose()">
                    <i class="fas fa-arrow-left"></i> Go Back
                </button>
                <button class="btn-confirm" onclick="adminPricing.confirmClose()">
                    <i class="fas fa-times"></i> Close Without Saving
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o Universal -->
    <div id="confirmModal" class="confirm-modal-overlay" style="display: none;">
        <div class="confirm-modal-container">
            <div class="confirm-modal-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 class="confirm-modal-title">You have unsaved changes!</h3>
            <p class="confirm-modal-message">
                Do you really want to close without saving?<br>
                Click OK to discard changes or Cancel to continue editing.
            </p>
            <div class="confirm-modal-buttons">
                <button class="confirm-btn confirm-btn-cancel" id="confirmCancel">Cancel</button>
                <button class="confirm-btn confirm-btn-ok" id="confirmOk">OK</button>
            </div>
        </div>
    </div>

    <!-- Loading Global -->
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="ui-modal-backdrop profile-modal-backdrop" style="display: none; z-index: 9000;">
        <div class="ui-modal profile-modal">
            <div class="ui-modal-header">
                <span class="modal-icon">üë§</span>
                <h3>My Profile</h3>
                <button class="modal-close" onclick="closeProfileModal()">‚úï</button>
            </div>

            <div class="ui-modal-body">
                <!-- Basic Information -->
                <div class="profile-info-box">
                    <p>
                        <strong>Username:</strong>
                        <span id="modalUsername">Admin</span>
                    </p>
                </div>

                <hr class="profile-divider">

                <!-- Change Password Form -->
                <h4 class="profile-section-title">Change Password</h4>

                <form id="changePasswordForm">
                    <div class="form-group">
                        <label class="form-label">Current Password:</label>
                        <input type="password" id="currentPassword" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">New Password:</label>
                        <input type="password" id="newPassword" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Confirm New Password:</label>
                        <input type="password" id="confirmPassword" class="form-input" required>
                    </div>
                </form>
            </div>

            <div class="ui-modal-footer">
                <button type="button" class="btn-secondary" onclick="closeProfileModal()">
                    Cancel
                </button>
                <button type="submit" class="btn-primary"
                    onclick="document.getElementById('changePasswordForm').dispatchEvent(new Event('submit'))">
                    Change Password
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/image-utils.js"></script>
    <script src="/js/zoom.js"></script>
    <script src="js/app.js"></script>
    <script src="js/admin-dashboard.js"></script>
    <script src="js/admin-clients.js"></script>
    <script src="js/admin-pricing.js"></script>
    <script src="js/admin-selections.js"></script>
    <script src="js/admin-config.js"></script>
    <script src="js/admin-marketing.js"></script>
    <script src="js/admin-storage.js"></script>
    <script src="js/inventory-monitor.js"></script>
    <script src="/js/ui-system.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</body>

</html>